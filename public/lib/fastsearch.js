var fuse;var fuseIndex;var searchVisible=false;var firstRun=true;var list=document.getElementById('searchResults');var first=list.firstChild;var last=list.lastChild;var maininput=document.getElementById('searchInput');var resultsAvailable=false;document.getElementById("searchInput").onfocus=function(e){if(firstRun){loadSearch()firstRun=false}}document.getElementById("searchInput").onkeyup=function(e){if(firstRun){loadSearch()firstRun=false}executeSearch(this.value);}function fetchJSONFile(path,callback){var httpRequest=new XMLHttpRequest();httpRequest.onreadystatechange=function(){if(httpRequest.readyState===4){if(httpRequest.status===200){var data=JSON.parse(httpRequest.responseText);if(callback)callback(data);}}};httpRequest.open('GET',path);httpRequest.send();}function loadSearch(){console.log('loadSearch()')fetchJSONFile('/index.json',function(data){var options={shouldSort:true,includeMatches:true,tokenize:true,matchAllTokens:true,threshold:0.8,location:0,distance:100,maxPatternLength:64,minMatchCharLength:2,keys:[{name:"title",weight:0.8},{name:"tags",weight:0.5},{name:"categories",weight:0.5},{name:"contents",weight:0.4}]};fuseIndex=Fuse.createIndex(options.keys,data)fuse=new Fuse(data,options,fuseIndex);});}function executeSearch(term){let results=fuse.search(term);let searchitems='';if(results.length===0){resultsAvailable=false;searchitems='';}else{permalinks=[];numLimit=5;for(let item in results){if(item>numLimit){break;}if(permalinks.includes(results[item].item.permalink)){continue;}searchitems=searchitems+'<li><a href="'+results[item].item.permalink+'" tabindex="0">'+'<span class="title">'+results[item].item.title+'</span></a></li>';permalinks.push(results[item].item.permalink);}resultsAvailable=true;}document.getElementById("searchResults").innerHTML=searchitems;if(results.length>0){first=list.firstChild.firstElementChild;last=list.lastChild.firstElementChild;}}