<!DOCTYPE html>
<html lang="zh-cn">
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>解决WP汉化和UTW链接问题 | 猪八的网：浮生志</title>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="author" content="Zhu8" />
	<meta name="generator" content="Hugo 0.99.0" />
	<meta name="description" content="其实严格说来是因为我在我要安家的服务器的关系，所以导致无法使用中文语言包。看下我要安家的配置：

操作系统 Linux Fedora core 1.0(2.4内核)或Linux Fedora core 2.0(2.6内核);
web服务器 Apache 1.3.31
PHP版本 PHP 4.3.11
Mysql版本 Mysql 4.0.20
Zend支持 支持

原来都是PHP版本搞的鬼，Wordpress默认的是PHP 5的，但是我现在的服务器是4.3.11，因为在wp-includes/gettext.php中第105行有这样一段代码：
// $MAGIC1 = (int)0x950412de; //bug in PHP 5.0.2, see https://savannah.nongnu.org/bugs/?func=detailitem&amp;item_id=10565  
$MAGIC1 = (int)&amp;1794895138;  
// $MAGIC2 = (int)0xde120495; //bug  
$MAGIC2 = (int)&amp;569244523;
其中注释掉的目的是为了修复PHP 5的错误的，因为我的服务器不是PHP 5，所以不需要注释掉。相反需要注释掉正在使用的，所以将上面那段代码替换成：" />
	<meta name="robots" content="index, follow" /> 
	<link type="text/css" rel="stylesheet" href="https://zhu8.net/dist/app.css" media="all" /> 
	<link rel="shortcut icon" href="https://zhu8.net/favicon.ico" type="image/x-icon" /> 
	<link rel="apple-touch-icon" href="https://zhu8.net/apple-touch-icon.png" />
	
	<script src="https://unpkg.com/@waline/client@v2/dist/waline.js"></script>
	<link type="text/css" rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css" />
	<link type="text/css" rel="stylesheet" href="https://zhu8.net/assets/css/custom.css" media="all" />
	<link type="text/css" rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.15.4/css/all.min.css" media="all" />
	<link rel=preconnect href=https://fonts.gstatic.com crossorigin>
	<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=ZCOOL+XiaoWei&family=Ma+Shan+Zheng&family=Long+Cang&display=swap" media=print onload='this.media="all"'>
	<noscript>
		<link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=ZCOOL+XiaoWei&family=Ma+Shan+Zheng&family=Long+Cang&display=swap">
	</noscript>
	
	<script>
		(function (u, c) {
			var d = document,
				t = 'script',
				o = d.createElement(t),
				s = d.getElementsByTagName(t)[0];
			o.src = u;
			if (c) {
				o.addEventListener('load', function (e) {
					c(e);
				});
			}
			s.parentNode.insertBefore(o, s);
		})('https:\/\/zhu8.net\/lib\/pangu.min.js', function () {
			pangu.spacingPage();
		});
	</script>
	
</head>

<body class="bg-gray-100 text-gray-700 font-sans">
	<div class="p-6 sm:p-10 md:p-16 flex flex-wrap">
		<header class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-1 md:order-1 max-w-2xl">
			<div
				class="z-50 bg-gray-100 bg-opacity-75 bg-opacity-custom lg:min-w-0.7 max-w-xl md:float-right md:text-right leading-loose tracking-tight md:sticky md:top-0 pt-2">
				 <div>
	<h1>
		<a href="https://zhu8.net/" title="猪八的网：浮生志" class="heading font-cursive icon">猪八的网：浮生志</a>
	</h1>
</div>
<h2 class="pt-2">
	<i class="far fa-bookmark"></i>解决WP汉化和UTW链接问题</h2>
<div class="flex flex-wrap justify-end pt-2 "><div class="md:flex-grow-0 font-light">
	<i class="fas fa-folder-open"></i>     <a class="post-taxonomy-category text-medium-red-violet-600 hover:text-medium-red-violet-400" href='https://zhu8.net/categories/%E7%9F%B3%E9%A9%AC-code/'>石马 | Code</a>   
	 &nbsp;&nbsp; 
	<i class="fas fa-tags"></i>  	 	 	 	<a class="post-taxonomy-tag text-eucalyptus-500" 		href='https://zhu8.net/tags/hack/'>Hack</a>&nbsp;&#47; 	 	<a class="post-taxonomy-tag text-eucalyptus-500" 		href='https://zhu8.net/tags/utw/'>UTW</a>&nbsp;&#47; 	 	<a class="post-taxonomy-tag text-eucalyptus-500" 		href='https://zhu8.net/tags/%E6%B1%89%E5%8C%96/'>汉化</a>&nbsp;&#47; 	 	<a class="post-taxonomy-tag text-eucalyptus-500" 		href='https://zhu8.net/tags/%E9%93%BE%E6%8E%A5/'>链接</a> 	 	 	
</div><time class="text-eucalyptus-500 md:text-right md:flex-grow font-light pl-4" datetime="2006-11-19T04:17:00&#43;08:00">
		<i class="fas fa-calendar-day"></i>2006-11-19 04:17 @ Sun</time>
</div>
<span class="a-gray text-md text-gray-500 leading-relaxed pt-2"><i class="fas fa-info"></i> 全文共 946 字，阅读需 <i class="fas fa-stopwatch"></i>  <span class="more-meta">4 分&nbsp;18 秒</span></span>

<hr /> 
			</div>
		</header>
		<main class="w-full md:w-3/5 xl:w-1/2 max-w-3xl order-2 md:order-2 min-h-70vh pt-2 pb-4">
			

<article>
	<div class="mx-auto content">
		<div class="c-rich-text"><p>其实严格说来是因为我在<a href="http://www.512j.com/" title="我要安家">我要安家</a>的服务器的关系，所以导致无法使用中文语言包。看下我要安家的配置：</p>
<blockquote>
<p>操作系统 Linux Fedora core 1.0(2.4内核)或Linux Fedora core 2.0(2.6内核);<br>
web服务器 Apache 1.3.31<br>
PHP版本 PHP 4.3.11<br>
Mysql版本 Mysql 4.0.20<br>
Zend支持 支持</p>
</blockquote>
<p>原来都是<strong>PHP版本</strong>搞的鬼，Wordpress默认的是PHP 5的，但是我现在的服务器是4.3.11，因为在<strong><strong>wp-includes/gettext.php</strong></strong>中<strong>第105行</strong>有这样一段代码：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#998;font-style:italic">// $MAGIC1 = (int)0x950412de; //bug in PHP 5.0.2, see https://savannah.nongnu.org/bugs/?func=detailitem&amp;item_id=10565  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#008080">$MAGIC1</span> <span style="color:#000;font-weight:bold">=</span> (int)<span style="color:#000;font-weight:bold">&amp;</span><span style="color:#099">1794895138</span>;  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// $MAGIC2 = (int)0xde120495; //bug  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#008080">$MAGIC2</span> <span style="color:#000;font-weight:bold">=</span> (int)<span style="color:#000;font-weight:bold">&amp;</span><span style="color:#099">569244523</span>;
</span></span></code></pre></div><p>其中注释掉的目的是为了修复PHP 5的错误的，因为我的服务器不是PHP 5，所以不需要<strong>注释</strong>掉。相反需要注释掉正在使用的，所以将上面那段代码替换成：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span> <span style="color:#008080">$MAGIC1</span> <span style="color:#000;font-weight:bold">=</span> (int)<span style="color:#099">0x950412de</span>; <span style="color:#998;font-style:italic">//bug in PHP 5.0.2, see https://savannah.nongnu.org/bugs/?func=detailitem&amp;item_id=10565  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span> <span style="color:#998;font-style:italic">// $MAGIC1 = (int)&amp;1794895138;  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span> <span style="color:#008080">$MAGIC2</span> <span style="color:#000;font-weight:bold">=</span> (int)<span style="color:#099">0xde120495</span>; <span style="color:#998;font-style:italic">//bug  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span> <span style="color:#998;font-style:italic">// $MAGIC2 = (int)&amp;569244523;
</span></span></span></code></pre></div><p>上面的解决方案是在<a href="http://wordpress.org/support/topic/66818" title="Language set up problem (portuguese) « WordPress Support">WordPress Support</a>找到的。好了，照上面做完一切OK了，现在可以正常使用中文包（zh_CN.mo以及zh_CN.po）了。这里放下本人正在使用的中文包：<a href="https://zhu8.net/uploads/zh_CN.rar" title="中文汉化包：zh_CN.mo和zh_CN.po">下载</a>，使用方法如下：</p>
<blockquote>
<p>下载编译好的zh_CN.mo文件(当然你也可以下载zh_CN.po文件然后自行编译)<br>
在Blog的wp-includes目录下建立languages文件夹<br>
将zh_CN.mo文件上传到wp-includes/languages文件夹<br>
修改Blog根目录下的wp-config.php文件，将<br>
define (‘WPLANG’, “);<br>
修改为<br>
define (‘WPLANG’, ‘zh_CN’);<br>
注意：zh和CN之间是下划线，引号和括号都是英文半角字符。</p>
</blockquote>
<p><em>Updated On 2006/11/20：</em></p>
<p>昨天把WP升级到了2.0.5，结果问题出来了，在先将所有的插件停用再启用的时候，其他的都可以，就是UTW（Ultimate Tag Warrior）的链接结构（Permalink Structure）不工作了，搞得我到处搜，去修改.htaccess文件，都不能解决，后来实在没辙了，把WP的链接结果先改成别的，再改回来，就OK了，虽然昨天我也试过，但是是在UTW还没有重新激活的情况下，将WP的链接结构重新升级了一遍之后才激活的UTW，所以没有起到作用。我的天啊，原来是这么简单的事情，偏偏我又是不见棺材不掉泪的类型，折腾到最后还是没弄好才回去睡觉的，记下来，以防自己（以及遇到此类问题的朋友）以后再干这种蠢事。Sigh……</p></div>
	</div>
</article>
		</main>
		<div class="w-full h-0 flex-none order-3"></div>
		<aside
			class="w-full md:w-2/5 xl:w-1/2 md:pr-12 lg:pr-20 xl:pr-24 order-4 md:order-3 md:sticky md:bottom-0 self-end max-w-2xl">
			<div class="md:float-right md:text-right leading-loose tracking-tight md:mb-2">
				 <div class="md:max-w-xs  flex flex-col md:items-end">
	<ul class="font-serif flex-grow-0 flex justify-between flex-wrap md:flex-col">
	 
	<li class="px-1 md:px-0">
		<a href="https://zhu8.net/blog/" title="Go to Blog § 日志"  class="font-medium text-medium-red-violet-600 hover:text-medium-red-violet-400" >Blog § 日志  <i class="fas fa-book"></i></a>
	</li> 
	<li class="px-1 md:px-0">
		<a href="https://zhu8.net/about/" title="Go to About § 关于" >About § 关于  <i class="fas fa-address-book"></i></a>
	</li> 
	<li class="px-1 md:px-0">
		<a href="https://zhu8.net/links/" title="Go to Links § 链接" >Links § 链接  <i class="fas fa-link"></i></a>
	</li> 
	<li class="px-1 md:px-0">
		<a href="https://zhu8.net/project/" title="Go to Project § 项目" >Project § 项目  <i class="fas fa-poo"></i></a>
	</li> 
	<li class="px-1 md:px-0">
		<a href="https://zhu8.net/categories/" title="Go to Categories § 分类" >Categories § 分类  <i class="fas fa-th-list"></i></a>
	</li> 
	<li class="px-1 md:px-0">
		<a href="https://zhu8.net/tags/" title="Go to Tags § 标签" >Tags § 标签  <i class="fas fa-tag"></i></a>
	</li> 
	<li class="px-1 md:px-0">
		<a href="https://zhu8.net/index.xml" title="Go to RSS § 订阅" >RSS § 订阅  <i class="fas fa-rss"></i></a>
	</li>  
	
	<li id="fastSearch" class="m-0">
		<input id="searchInput" type="text" size=10 class="bg-gray-100 focus:outline-none border-b border-gray-100 focus:border-eucalyptus-300 md:text-right placeholder-java-500 min-w-0 max-w-xxxs" placeholder="Type, Search!" /><i class="fas fa-search"></i>
		<ul id="searchResults" class="bg-gray-200 px-2 divide-y divide-gray-400"> </ul>
	</li> 
</ul>
	<img src="https://zhu8.net/images/dora-three.png" id="dora-three" alt="Doraemon-Stand By Me!" title="Doraemon-Stand By Me!">
	<div class="font-medium text-xl flex flex-wrap-reverse">
  
  <a href="https://twitter.com/5CJ" aria-label="Twitter"  title="View My Twitter"><i id="twitter-ic" class="fab fa-twitter" aria-hidden="true"></i></a>  
  
  <a href="https://facebook.com/ichenjun" aria-label="Facebook"  title="View My Facebook"><i id="facebook-ic" class="fab fa-facebook" aria-hidden="true"></i></a> 
  
  <a href="https://weibo.com/zhu8" aria-label="Weibo"  title="View My Weibo"><i id="weibo-ic" class="fab fa-weibo" aria-hidden="true"></i></a>  
  
  <a href="https://github.com/zhu8" aria-label="Github"  title="View My Github"><i id="github-ic" class="fab fa-github" aria-hidden="true"></i></a>  
  
  <a href="https://instagram.com/5CJ" aria-label="Instagram"  title="View My Instagram"><i id="instagram-ic" class="fab fa-instagram" aria-hidden="true"></i></a>  
  
  <a href="https://gitlab.com/zhu8.net" aria-label="Gitlab"  title="View My Gitlab"><i id="gitlab-ic" class="fab fa-gitlab" aria-hidden="true"></i></a>  
  
  <a href="https://zhu8.tumblr.com" aria-label="Tumblr"  title="View My Tumblr"><i id="tumblr-ic" class="fab fa-tumblr-square" aria-hidden="true"></i></a>  
</div>
	<div class="text-sm text-gray-500 leading-tight a-gray">
		
		<i class="fas fa-paint-roller"></i>Life is Colorful, Just PAINT.<br />
		<i class="fas fa-code-branch"></i>Theme with <a href="https://github.com/heyeshuang/hugo-theme-tokiwa">Tokiwa</a>, Powered by <a href="https://gohugo.io"><span style="color:#f40083">H</span><span style="color:#246dd6">U</span><span style="color:#4dc47d">G</span><span style="color:#fcb643">O</span></a>.<br />
		
		<i class="fas fa-copyright"></i>2004-2022 &sect;Zhu8, [<a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA</a>].
	</div>
</div> 
			</div>
		</aside>
		<footer class="w-full md:w-3/5 xl:w-1/2 order-3 max-w-3xl md:order-4 pt-2">
			 
<div class="a-gray text-sm text-gray-500 leading-tight pb-6"><i class="fas fa-pencil-alt"></i> LastMod @ <em>2006-11-19</em> & Pageviews: <i class="waline-pageview-count"></i></div>
<hr class="double-line" />
<div class="flex flex-wrap justify-between pb-2 leading-loose font-serif">
    
    <a class="flex-grow-0" href="https://zhu8.net/blog/2006/11/small-cases.html"> 
        <svg class="fill-current inline-block h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
            <path fill="none" d="M0 0h24v24H0z" />
            <path d="M7.828 11H20v2H7.828l5.364 5.364-1.414 1.414L4 12l7.778-7.778 1.414 1.414z" />
        </svg> 二三事 </a> 
    
    <a class="flex-grow-0" href="https://zhu8.net/blog/2006/11/trouble-with-so-much-things.html"> 发现自己原来一根筋 
        <svg class="fill-current inline-block h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">
            <path fill="none" d="M0 0h24v24H0z" />
            <path d="M16.172 11l-5.364-5.364 1.414-1.414L20 12l-7.778 7.778-1.414-1.414L16.172 13H4v-2z" />
        </svg></a> 
</div>
<div>
      
    <div class="font-serif pb-2 flex align-start leading-loose">
        <span class="heading pr-6 leading-loose">Related</span>
        <span>
             <a href="https://zhu8.net/blog/2006/11/small-cases.html">二三事</a>&nbsp;&nbsp;&#47;&nbsp;  <a href="https://zhu8.net/blog/2006/08/usebb-chinese-simplified.html">UseBB汉化暨论坛搭建完成</a>&nbsp;&nbsp;&#47;&nbsp;  <a href="https://zhu8.net/blog/2006/07/my-wordpress-plugins.html">我的WordPress插件列表</a> 
        </span>
    </div> 
</div>
<hr />
<div class="pb-2">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4945528698886553" crossorigin="anonymous"></script>
    <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-4945528698886553" data-ad-slot="2174653532"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    
<div id="waline"></div>
<script>
  Waline.init({
    el: '#waline',
    serverURL: 'https://comm.zhu8.net',
    visitor: true,
    pageview: true,
    imageUploader: false,
    avatar:'robohash',
    uploadImage: false,
    emoji: [
    'https://zhu8.net/images/smilies/',
    'https://unpkg.com/@waline/emojis@1.0.1/qq',
  ],
  });
</script>
</div>
<hr /> 
		</footer>
		

<script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js"></script>
<script>
      
      (window.jQuery)||document.write('<script type="text/javascript" src="//ajax.aspnetcdn.com/ajax/jquery/jquery-3.6.0.min.js"><\/script>');
</script>
<script src="https://zhu8.net/assets/js/go-top.js"></script>
<script src="https://zhu8.net/dist/app.js"></script>
<script src="https://cdn.staticfile.org/fuse.js/6.4.6/fuse.min.js"></script>
<script src="https://zhu8.net/lib/fastsearch.js"></script>
<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?196df30ee1fd16193ded942dd171698a";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-DH1JSGY8RB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-DH1JSGY8RB');
</script>

	</div>
</body>
</html>